<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>SP360Converter</title>
</head>

<body>
    <h1>SP360Converter</h1>

    <div>
        <button onclick="test()">Test Run</button>
    </div>
    <div>
        <canvas id="screen" width="300" height="200"></canvas>
    </div>
    <script>
        var remote = require('remote');
        var converter = remote.require('./build/Release/converter');
        var app = remote.require('app');
        var BrowserWindow = remote.require('browser-window');
        var dialog = remote.require('dialog');

        var showMsg = function(message) {
            var options = {
                title: 'Message from callback',
                type: 'info',
                buttons: ['OK', 'Cancel'],
                message: 'Callback passs',
                detail: message
            };
            var win = BrowserWindow.getFocusedWindow();
            dialog.showMessageBox(win, options);
        };

        showSaveDialog = function(flag) {
            var options = {
                title: 'Save Dialog Example',
                defaultPath: app.getPath('userDesktop'),
                filters: [{
                    name: 'Images',
                    extensions: ['jpg', 'png', 'gif']
                }, {
                    name: 'Documents',
                    extensions: ['txt', 'html']
                }, ]
            };
            if (flag) {
                var win = BrowserWindow.getFocusedWindow();
                dialog.showSaveDialog(win, options, function(filename) {
                    showMsg(filename);
                });
            } else {
                dialog.showSaveDialog(options, function(filename) {
                    showMsg(filename);
                });
            }
        };

        showOpenDialog = function(flag) {
            var options = {
                title: 'Open Dialog Example',
                defaultPath: app.getPath('userDesktop'),
                filters: [{
                    name: 'Images',
                    extensions: ['jpg', 'png', 'gif']
                }, {
                    name: 'Documents',
                    extensions: ['txt', 'html']
                }, ],
                properties: ['openFile', 'multiSelections', 'createDirectory']
            };
            if (flag) {
                var win = BrowserWindow.getFocusedWindow();
                dialog.showOpenDialog(win, options, function(filenames) {
                    showMsg(filenames);
                });
            } else {
                dialog.showOpenDialog(options, function(filenames) {
                    showMsg(filenames);
                });
            }
        };

        showMessageBox = function(flag) {
            var options = {
                title: 'Message Box Example',
                type: 'info',
                buttons: ['OK', 'Cancel', 'Info'],
                message: 'Message Box Example',
                detail: 'Extra info'
            };
            if (flag) {
                var win = BrowserWindow.getFocusedWindow();
                dialog.showMessageBox(win, options, function(response) {
                    showMsg(response.toString());
                });
            } else {
                dialog.showMessageBox(options, function(response) {
                    showMsg(response.toString());
                });
            }
        };

        showErrorBox = function() {
            dialog.showErrorBox('Error Box Example', 'Error Box');
        };


        function test() {
            //showOpenDialog();
            /*
            var canvas = document.getElementById('screen');
            var context = canvas.getContext('2d');
            var imageData = context.createImageData(300, 200);
            mandelbrot.mandelbrot(imageData.data);
            context.putImageData(imageData, 0, 0);
            */
            /*
            converter.convert(function(progress) {
                console.log(progress);
            });
            */

            var data = {
                size: 10000,
            }


            var x = converter.convert({
                start_time:0,
                end_time:5,
            }, function(err, status, progress){
                console.log(status);
                console.log(progress);
            });
        }
    </script>

    </div>
</body>

</html>
